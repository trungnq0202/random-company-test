(this["webpackJsonpfrontend-react"]=this["webpackJsonpfrontend-react"]||[]).push([[0],{100:function(e,t,n){},101:function(e,t,n){},102:function(e,t,n){},103:function(e,t,n){},105:function(e,t,n){},106:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(35),s=n.n(r),c=n(14),o=n(62),i=n(26),u=n(48),l=n(58),d=n(23),h=n(2),j=1,p=2,b=3,O=4,m="LOGIN_START",f="LOGIN_SUCCESS",g="LOGIN_FAIL",x="AUTH_LOGOUT",v=m,S=f,y=g,w=x,k={account:{},loginStatus:j,token:null};function C(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:return Object(h.a)(Object(h.a)({},e),{},{loginStatus:p});case S:return Object(h.a)(Object(h.a)({},e),{},{loginStatus:b,account:t.payload.account,token:t.payload.token});case y:return Object(h.a)(Object(h.a)({},e),{},{loginStatus:O});case w:return Object(h.a)(Object(h.a)({},e),{},{loginStatus:j,token:null,account:null});default:return e}}var _=1,T=2,D=1,I=2,U=4,E=5,N="FIND_USERS_BY_NAME",A="START_EDIT_USERS",L="END_EDIT_USERS",R="START_UPDATE_USERS",B="NOT_UPDATE_USERS",M="UPDATE_USERS_PARTIALLY_SUCCESS",P="UPDATE_USERS_FAIL",Y="UPDATE_SUCCESS",z=n(40),H=function(e,t){for(var n=Object(z.a)(e),a=0;a<e.length;++a)for(var r=0;r<t.length;++r){var s=e[a],c=t[r];if(s._id===c._id){c.username===s.username&&c.email===s.email&&c.birthdate===s.birthdate||(n[a]=t[r]);break}}return console.log("concac"),console.log(e),console.log("cailoz"),console.log(t),console.log("baby"),console.log(n),n},F=N,W=A,G=L,J=R,q=B,V=M,K=P,Q=Y,X={users:[],editStatus:T,updateStatus:D};function Z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case F:return Object(h.a)(Object(h.a)({},e),{},{users:t.users});case W:return Object(h.a)(Object(h.a)({},e),{},{editStatus:_});case G:return Object(h.a)(Object(h.a)({},e),{},{editStatus:T});case q:return Object(h.a)(Object(h.a)({},e),{},{updateStatus:D});case J:return Object(h.a)(Object(h.a)({},e),{},{updateStatus:I});case V:return Object(h.a)(Object(h.a)({},e),{},{updateStatus:U,users:H(e.users,t.payload.users)});case K:return Object(h.a)(Object(h.a)({},e),{},{updateStatus:E});case Q:return Object(h.a)(Object(h.a)({},e),{},{updateStatus:D,users:H(e.users,t.payload.users)});default:return e}}var $=function(e){return Object(i.combineReducers)({auth:C,userManagement:Z,router:Object(d.b)(e)})},ee=n(61),te=Object(o.a)();var ne=n(16),ae=n(17),re=n(19),se=n(18),ce=n(8),oe=n(21),ie=n.n(oe),ue=n(32),le=n(11),de=n(63),he=n.n(de).a.create({baseURL:"http://localhost:8080/api/"}),je=m,pe=f,be=g,Oe=x,me=function(){var e=localStorage.getItem("token");return function(){var t=Object(ue.a)(ie.a.mark((function t(n){return ie.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,he.post("/admin/logout",localStorage.getItem("account"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});case 2:localStorage.removeItem("token"),localStorage.removeItem("expirationDate"),localStorage.removeItem("account"),n({type:Oe});case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},fe=function(e){return function(t){setTimeout((function(){t(me())}),1e3*e)}},ge=function(e){var t=localStorage.getItem("token");return function(){var n=Object(ue.a)(ie.a.mark((function n(a,r){return ie.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e({type:je}),he.post("/admin/auth",{username:a,password:r},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(t){var n=new Date((new Date).getTime()+1e3*t.data.expiresIn);localStorage.setItem("token",t.data.token),localStorage.setItem("expirationDate",n),localStorage.setItem("account",JSON.stringify(t.data.account));var a={account:t.data.account,token:t.data.token};e({type:pe,payload:a}),e(fe(t.data.expiresIn)),e(Object(le.d)("/user-management"))})).catch((function(t){e({type:be})}));case 2:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()},xe=n(107),ve=n(66),Se=n(113),ye=n(38),we=n(68),ke=n(67),Ce=n(114),_e=n(108),Te=n(64),De=n(65),Ie=Object(Te.a)((function(e){return Object(De.get)(e,"auth.loginStatus")}),(function(e){return e})),Ue=(n(97),n(1)),Ee=function(e){Object(re.a)(n,e);var t=Object(se.a)(n);function n(e){var a;return Object(ne.a)(this,n),(a=t.call(this,e)).onUsernameChange=function(e){a.setState({username:e.target.value})},a.onPasswordChange=function(e){a.setState({password:e.target.value})},a.login=function(){var e=a.state,t=e.username,n=e.password;a.props.login(t,n)},a.state={username:"",password:""},a}return Object(ae.a)(n,[{key:"renderError",value:function(){switch(this.props.status){case p:return Object(Ue.jsx)("span",{children:"Validating account..."});case O:return Object(Ue.jsx)("span",{children:"Username or password is incorrect"});default:return null}}},{key:"render",value:function(){return Object(Ue.jsx)(xe.a,{children:Object(Ue.jsx)(ve.a,{md:4,className:"mx-auto mt-5",children:Object(Ue.jsxs)(Se.a,{children:[Object(Ue.jsx)("h3",{children:"Login with admin account"}),Object(Ue.jsxs)(ye.a,{children:[Object(Ue.jsx)(we.a,{children:"Username"}),Object(Ue.jsx)(ke.a,{type:"text",placeholder:"Username",onChange:this.onUsernameChange,value:this.state.username})]}),Object(Ue.jsxs)(ye.a,{className:"mt-4",children:[Object(Ue.jsx)(we.a,{children:"Password"}),Object(Ue.jsx)(ke.a,{type:"Password",placeholder:"Enter password",onChange:this.onPasswordChange,value:this.state.password})]}),Object(Ue.jsx)(Ce.a,{className:"mt-4",block:!0,size:"lg",bsstyle:"primary",onClick:this.login,children:"Login"}),Object(Ue.jsx)(_e.a,{children:this.renderError()})]})})})}}]),n}(a.Component);var Ne=Object(c.c)((function(e){return{status:Ie(e)}}),(function(e){return{login:ge(e)}}))(Ee),Ae=N,Le=A,Re=L,Be=R,Me=B,Pe=M,Ye=P,ze=Y,He=function(e){var t=localStorage.getItem("token");return function(n){he.get("/users/get-all-by-name",{params:{name:e},headers:{Authorization:"Bearer ".concat(t)}}).then((function(e){var t;n((t=e.data,{type:Ae,users:t}))})).catch((function(e){}))}},Fe=n(46),We=n.n(Fe),Ge=function(e){return e.children},Je=n(29),qe=n(109),Ve=n(110),Ke=n(111),Qe=n(22),Xe=n.n(Qe),Ze=function(e){Object(re.a)(n,e);var t=Object(se.a)(n);function n(e){var a;return Object(ne.a)(this,n),(a=t.call(this,e)).showDropdownItems=function(){a.setState((function(e){return Object(h.a)(Object(h.a)({},e),{},{showDropdownItem:!e.showDropdownItem})}))},a.state={showDropdownItem:!1},a}return Object(ae.a)(n,[{key:"componentDidMount",value:function(){var e=this;window.onclick=function(t){t.target.className!==Xe.a.dropbtn&&e.setState({showDropdownItem:!1})}}},{key:"render",value:function(){var e=[Xe.a.dropdownContent];return this.state.showDropdownItem&&(e=[Xe.a.dropdownContent,Xe.a.show]),Object(Ue.jsxs)("header",{className:Xe.a.Toolbar,children:[Object(Ue.jsxs)("nav",{children:[Object(Ue.jsx)(qe.a,{}),Object(Ue.jsx)("h4",{children:this.props.title})]}),Object(Ue.jsx)(Je.a,{to:"/user-management",style:{color:"white"},activeStyle:{fontWeight:"bold",color:"red"},children:"User Management"}),Object(Ue.jsx)(Je.a,{to:"/family-tree",style:{color:"white"},activeStyle:{fontWeight:"bold",color:"red"},children:"Family tree rendering"}),Object(Ue.jsx)("nav",{children:Object(Ue.jsxs)("div",{className:Xe.a.dropdown,children:[Object(Ue.jsxs)("button",{onClick:this.showDropdownItems,className:Xe.a.dropbtn,children:[Object(Ue.jsx)(Ve.a,{style:{marginRight:"5px"}}),this.props.username,Object(Ue.jsx)(Ke.a,{style:{marginLeft:"5px"}})]}),Object(Ue.jsx)("div",{id:"myDropdown",className:e.join(" "),children:Object(Ue.jsx)("button",{onClick:this.props.logoutBtnHandler,children:"Logout"})})]})})]})}}]),n}(a.Component),$e=(n(99),function(e){Object(re.a)(n,e);var t=Object(se.a)(n);function n(){return Object(ne.a)(this,n),t.apply(this,arguments)}return Object(ae.a)(n,[{key:"render",value:function(){return Object(Ue.jsxs)(Ge,{children:[Object(Ue.jsx)(Ze,{title:this.props.title,username:this.props.username,logoutBtnHandler:this.props.onLogout}),Object(Ue.jsx)("main",{className:"Content",children:this.props.children})]})}}]),n}(a.Component));var et,tt=Object(c.c)(null,(function(e){return{onLogout:function(){return e(me())}}}))($e),nt=n(20),at=n(112),rt=(n(100),function(e){var t=Object(a.useState)(""),n=Object(nt.a)(t,2),r=n[0],s=n[1];return Object(Ue.jsx)(Ge,{children:Object(Ue.jsx)("div",{className:"wrap",children:Object(Ue.jsxs)("div",{className:"search",children:[Object(Ue.jsx)("input",{type:"text",className:"searchTerm",onChange:function(e){s(e.target.value)},placeholder:"Enter name to search users"}),Object(Ue.jsx)("button",{type:"submit",className:"searchButton",onClick:function(){e.executeSearch(r)},children:Object(Ue.jsx)(at.a,{})})]})})})}),st=(n(101),function(e){Object(re.a)(n,e);var t=Object(se.a)(n);function n(e){var a;return Object(ne.a)(this,n),(a=t.call(this,e)).editBtnClickHandler=function(e){0!==a.props.users.length&&a.props.changeEditStatus(a.props.editStatus)},a.finishEditBtnClickHandler=function(e){a.props.changeEditStatus(a.props.editStatus),a.props.updateUsers(function(e,t){for(var n=[],a=0;a<t.length;++a){var r=e[a],s=t[a];s.username===r.username&&s.email===r.email&&s.birthdate===r.birthdate||n.push(s)}return n}(a.props.users,a.state.users))},a.onUserDataChange=function(e,t,n,r){var s=Object(z.a)(a.state.users),c=Object(h.a)({},s[e]);t&&(c.username=t),n&&(c.email=n),r&&(c.birthdate=r),s[e]=c,a.setState({users:s})},a.state={users:[]},a}return Object(ae.a)(n,[{key:"componentWillReceiveProps",value:function(e){e.users!==this.props.users&&this.setState({users:e.users})}},{key:"renderError",value:function(){switch(this.props.updateStatus){case I:return Object(Ue.jsx)("span",{style:{height:15,width:"100%"},children:"Updating users....."});case U:return Object(Ue.jsx)("span",{style:{height:"100%",width:"100%",color:"red"},children:"Some users are failed to update, remember username must be unique and email must have the right form"});case E:return Object(Ue.jsx)("span",{style:{height:"100%",width:"100%",color:"red"},children:"Fail to update editted users, remember username must be unique and email must have the right form"});default:return null}}},{key:"render",value:function(){var e=this;return Object(Ue.jsx)(tt,{children:Object(Ue.jsx)(xe.a,{children:Object(Ue.jsxs)("div",{style:{height:700,width:"100%"},children:[Object(Ue.jsx)(rt,{executeSearch:this.props.fetchUsers}),Object(Ue.jsx)("div",{className:"mt-3",style:{height:30,width:"100%",textAlign:"center"},children:this.renderError()}),Object(Ue.jsxs)("table",{className:"table mt-4",id:"users",children:[Object(Ue.jsx)("thead",{children:Object(Ue.jsxs)("tr",{children:[Object(Ue.jsx)("th",{scope:"col",id:"usernameTh",children:"Username"}),Object(Ue.jsx)("th",{scope:"col",id:"emailTh",children:"Email"}),Object(Ue.jsx)("th",{scope:"col",id:"dobTh",children:"Birthdate"}),Object(Ue.jsx)("th",{style:{wdith:"10%"},children:this.props.editStatus===T?Object(Ue.jsx)(Ce.a,{onClick:this.editBtnClickHandler,children:"Edit"}):Object(Ue.jsx)(Ce.a,{onClick:this.finishEditBtnClickHandler,children:"Finish"})})]})}),Object(Ue.jsx)("tbody",{children:this.state.users.map((function(t,n){return Object(Ue.jsxs)("tr",{children:[Object(Ue.jsx)("td",{children:e.props.editStatus===_?Object(Ue.jsx)("input",{value:t.username,type:"text",onChange:function(t){return e.onUserDataChange(n,t.target.value,void 0,void 0)}}):t.username}),Object(Ue.jsx)("td",{children:e.props.editStatus===_?Object(Ue.jsx)("input",{value:t.email,type:"email",onChange:function(t){return e.onUserDataChange(n,void 0,t.target.value,void 0)}}):t.email}),Object(Ue.jsx)("td",{children:e.props.editStatus===_?Object(Ue.jsx)("input",{value:We()(t.birthdate).format("YYYY-MM-DD"),type:"date",onChange:function(t){return e.onUserDataChange(n,void 0,void 0,t.target.value)}}):We()(t.birthdate).format("YYYY-MM-DD")})]},t._id)}))})]})]})})})}}]),n}(a.Component)),ct=Object(c.c)((function(e){return{account:e.auth.account,users:e.userManagement.users,editStatus:e.userManagement.editStatus,updateStatus:e.userManagement.updateStatus}}),(function(e){return{fetchUsers:function(t){return e(He(t))},changeEditStatus:function(t){return e(function(e){return function(t){e===T?(t({type:Le}),t({type:Me})):t({type:Re})}}(t))},updateUsers:function(t){return e(function(e){var t=localStorage.getItem("token");return function(){var n=Object(ue.a)(ie.a.mark((function n(a){return ie.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a({type:Be}),he.post("/users/update-multiple",e,{headers:{Authorization:"Bearer ".concat(t)}}).then((function(e){e.data.errorCode?1===e.data.errorCode?a({type:Pe,payload:{users:e.data.finalizedUsers}}):a({type:Ye}):a({type:ze,payload:{users:e.data.finalizedUsers}})})).catch((function(e){a({type:Ye})}));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(t))}}}))(st),ot=n(5),it=["component","auth"],ut=function(e){var t=e.component,n=e.auth,a=Object(ot.a)(e,it);return Object(Ue.jsx)(ce.b,Object(h.a)(Object(h.a)({},a),{},{render:function(e){return!0===n?Object(Ue.jsx)(t,Object(h.a)({},e)):Object(Ue.jsx)(ce.a,{to:"/"})}}))},lt=(n(102),function(){return Object(Ue.jsx)(tt,{children:Object(Ue.jsx)(xe.a,{children:Object(Ue.jsx)(_e.a,{children:Object(Ue.jsx)(ve.a,{md:12,className:"mx-auto mt-5",children:Object(Ue.jsxs)("div",{class:"error-template",children:[Object(Ue.jsx)("h1",{children:"Oops!"}),Object(Ue.jsx)("h2",{children:"404 Not Found"}),Object(Ue.jsx)("div",{class:"error-details",children:"Sorry, an error has occured, Requested page not found!"})]})})})})})}),dt=(n(103),function(e){Object(re.a)(n,e);var t=Object(se.a)(n);function n(){return Object(ne.a)(this,n),t.apply(this,arguments)}return Object(ae.a)(n,[{key:"componentWillMount",value:function(){this.props.autoLoggingIn()}},{key:"render",value:function(){var e=Object(Ue.jsxs)(ce.d,{children:[Object(Ue.jsx)(ut,{path:"/user-management",component:ct,auth:this.props.isAuthenticated}),Object(Ue.jsx)(ce.b,{path:"/",exact:!0,component:Ne}),Object(Ue.jsx)(ce.b,{path:"*",component:lt})]});return Object(Ue.jsx)(d.a,{history:this.props.history,children:e})}}]),n}(a.Component)),ht=Object(c.c)((function(e){return{isAuthenticated:null!=e.auth.account}}),(function(e){return{autoLoggingIn:function(){return e((function(e){if(localStorage.getItem("token")){var t=new Date(localStorage.getItem("expirationDate"));if(t<=new Date)e(me());else{var n={account:JSON.parse(localStorage.getItem("account")),token:localStorage.getItem("token")};e({type:pe,payload:n}),e(fe((t.getTime()-(new Date).getTime())/1e3)),e(Object(le.d)("/user-management"))}}else e(me())}))}}}))(dt),jt=(n(104),n(105),Object(i.createStore)($(te),Object(l.composeWithDevTools)(Object(i.applyMiddleware)(ee.a,Object(u.a)(te))),et));s.a.render(Object(Ue.jsx)(c.a,{store:jt,children:Object(Ue.jsx)(ht,{history:te})}),document.getElementById("root"))},22:function(e,t,n){e.exports={Toolbar:"Toolbar_Toolbar__2u0f3",Logo:"Toolbar_Logo__2A45x",dropbtn:"Toolbar_dropbtn__1tHWx",dropdown:"Toolbar_dropdown__Dh8Se",dropdownContent:"Toolbar_dropdownContent__18ShR",show:"Toolbar_show__OsocV"}},97:function(e,t,n){},99:function(e,t,n){}},[[106,1,2]]]);
//# sourceMappingURL=main.135b1661.chunk.js.map